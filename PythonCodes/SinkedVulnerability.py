"""
SinkedVulnerability class that inherits from Vulnerability class which in addition
holds an array named sameSink that holds list of instance ID's with the same sink
location
"""
from PythonCodes.Vulnerability import Vulnerability

class SinkedVulnerability(Vulnerability):

    def __init__(self, id, instanceid, kingdom, category, primaryFunction, filename, severity, function, line, replacementDefinitions):
        Vulnerability.__init__(self, id, instanceid, kingdom, category, primaryFunction, filename, severity, function, line, replacementDefinitions)
        self.sameSink = []
        self.sourceFunction = ""
        self.sharedPath = ""

    def getRuleId(self):
        return self.id

    def getInstanceid(self):
        return self.instanceid

    def getSameSink(self):
        return self.sameSink

    def getSourceFunction(self):
        return self.sourceFunction

    def getTraces(self):
        return self.traces

    def getReplacementDefinitions(self):
        return self.replacementDefinitions

    def getKingdom(self):
        return self.kingdom

    def getCategory(self):
        return self.category

    def getFilename(self):
        return self.filename

    def getLine(self):
        return self.line

    def getFunction(self):
        return self.function

    def getSeverity(self):
        return self.severity

    def getSameSink(self):
        return self.sameSink

    def __str__(self):
        strTemp = ""
        strTemp += " ID is %s, Kingdom is %s Category is %s, Filename is %s line is %s, function is %s severity is %s \n" % (self.id, self.kingdom, self.category, self.filename, self.line, self.function, self.severity)
        strTemp += " Replacement Definitions Dictionary is %s \n" % (self.replacementDefinitions)
        strTemp += " Same Sinked Vulnerabilities are: "
        strTemp2 = "--".join(str(e) for e in self.sameSink)
        strTemp += strTemp2
        strTemp += "\n"
        return strTemp